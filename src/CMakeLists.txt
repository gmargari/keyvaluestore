cmake_minimum_required (VERSION 2.6)
project (KEYVALUESTORE)

add_library (KeyValueStore              KeyValueStore.cpp)
add_library (MemStore                   MemStore.cpp)
add_library (DiskStore                  DiskStore.cpp)
add_library (KVTMap                     KVTMap.cpp)
add_library (KVTDiskFile                KVTDiskFile.cpp)
add_library (KVTInputStream             KVTInputStream.cpp)
add_library (KVTMapInputStream          KVTMapInputStream.cpp)
add_library (KVTDiskFileInputStream     KVTDiskFileInputStream.cpp)
add_library (KVTDiskFileOutputStream    KVTDiskFileOutputStream.cpp)
add_library (KVTPriorityInputStream     KVTPriorityInputStream.cpp)
add_library (CompactionManager          CompactionManager.cpp)
add_library (ImmCompactionManager       ImmCompactionManager.cpp)
add_library (GeomCompactionManager      GeomCompactionManager.cpp)
add_library (LogCompactionManager       LogCompactionManager.cpp)
add_library (UrfCompactionManager       UrfCompactionManager.cpp)
add_library (KVTSerialization           KVTSerialization.cpp)
add_library (Range                      Range.cpp)
add_library (VFile                      VFile.cpp)
add_library (VFileIndex                 VFileIndex.cpp)
add_library (Simulator                  Simulator.cpp)

target_link_libraries (KVTDiskFile               VFile)
target_link_libraries (MemStore                  KVTMap)
target_link_libraries (DiskStore                 KVTDiskFile VFile)
target_link_libraries (ImmCompactionManager      CompactionManager)
target_link_libraries (GeomCompactionManager     CompactionManager)
target_link_libraries (LogCompactionManager      CompactionManager)
target_link_libraries (UrfCompactionManager      CompactionManager Range)
target_link_libraries (VFile                     VFileIndex Simulator)
target_link_libraries (KVTMapInputStream         KVTInputStream)
target_link_libraries (KVTDiskFileInputStream    KVTSerialization KVTInputStream)
target_link_libraries (KVTDiskFileOutputStream   KVTSerialization)
target_link_libraries (KVTPriorityInputStream    KVTDiskFileInputStream KVTMapInputStream)

target_link_libraries (ImmCompactionManager MemStore DiskStore KVTMapInputStream KVTDiskFileInputStream KVTDiskFileOutputStream KVTPriorityInputStream)
target_link_libraries (GeomCompactionManager MemStore DiskStore KVTMapInputStream KVTDiskFileInputStream KVTDiskFileOutputStream KVTPriorityInputStream)
target_link_libraries (LogCompactionManager MemStore DiskStore KVTMapInputStream KVTDiskFileInputStream KVTDiskFileOutputStream KVTPriorityInputStream)
target_link_libraries (UrfCompactionManager MemStore DiskStore KVTMapInputStream KVTDiskFileInputStream KVTDiskFileOutputStream KVTPriorityInputStream)
target_link_libraries (KeyValueStore MemStore DiskStore ImmCompactionManager GeomCompactionManager LogCompactionManager UrfCompactionManager)

add_executable (sim main.cpp)
target_link_libraries (sim KeyValueStore)

add_subdirectory (test)
add_subdirectory (tools)
